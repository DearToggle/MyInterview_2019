
1

 课程分为免费和收费两种. 对于收费课程, 用户需提交订单并完成支付方可在线学习;

 支付成功即 完成订单, 订单完成后系统需要自动添加选课;

 干的什么事情? 实现 支付成功,自动添加选课信息------- 支付成功后,订单支付表 修改支付为成功/ 选课表中添加,学生选课记录;

2

  订单服务 维护订单数据库;  学习服务维护学习数据库; 这里面牵扯到分布式事务一致性的问题;


 本地事务:通过关系数据库来控制事务/ 关系数据库通常都具有ACID特性;

 在分布式系统中一次操作由多个系统协同完成,一次事务操作设计到多个系统通过网络协同完成的过程称为分布式事务;


3 我们的解决方案:  通过消息队列实现最终一致性; 

具体点: 将分布式事务拆分成多个本地事务来完成,并且由消息队列异步协调完成;

实现最终事务一致要求: 如果执行失败会进行重试, 要求业务执行方法实现幂等;


优点: 由MQ 按照异步方式协调完成事务;

缺点: 基于数据库本地事务来实现, 会出现频繁读写数据库记录/ 对于高并发操作不是最佳方案;

4 具体操作;

 订单服务:

   订单状态表; 待处理任务表; 任务历史表;

 考虑到分布式系统 并发读取任务的情况,使用 乐观锁的方式解决并发问题;

 学习服务中:

       学生选课表; 历史任务表;


5 实际操作一遍,最好是;











